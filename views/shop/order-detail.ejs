<div class="container mt-4">
  <h2>Chi tiết đơn hàng</h2>
  <div class="card mt-3">
    <div class="card-body">
      <p><strong>Mã đơn hàng:</strong> #<%= order._id.toString().slice(-8) %></p>
      <p>
        <strong>Khách hàng:</strong> 
        <%= order.customer ? order.customer.fullName : 'N/A' %> - 
        <%= order.customer ? order.customer.phone : '' %>
      </p>
      <p><strong>Ngày đặt:</strong> <%= new Date(order.createdAt).toLocaleString('vi-VN') %></p>
      <p><strong>Ngày sự kiện:</strong> 
        <%= order.eventDate ? new Date(order.eventDate).toLocaleDateString('vi-VN') : 'Chưa có' %>
      </p>
      <p><strong>Địa điểm:</strong> <%= order.eventLocation %></p>
      <p>
        <strong>Trạng thái:</strong> <%= order.status %> • 
        <strong>Thanh toán:</strong> <%= order.paymentStatus %>
      </p>
      <hr />
      <h5>Dịch vụ</h5>
      <ul class="list-group mb-3">
        <% order.services.forEach(item => { %>
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><strong><%= item.service ? item.service.title : 'Dịch vụ' %></strong></div>
              <div class="text-muted small">Số lượng: <%= item.quantity %></div>
            </div>
            <div><strong><%= (item.price * item.quantity).toLocaleString() %> VNĐ</strong></div>
          </li>
        <% }) %>
      </ul>
      <p class="h5">Tổng: <strong class="text-primary"><%= order.totalAmount.toLocaleString() %> VNĐ</strong></p>

      <div class="mt-3 d-flex gap-2">
        <a href="/customer/shop/orders" class="btn btn-outline-secondary">Quay lại</a>

        <% if (order.status !== 'completed' && order.status !== 'cancelled') { %>
          <form action="/customer/shop/orders/<%= order._id %>/request-confirm" method="POST" class="d-inline">
            <button type="submit" class="btn btn-success">
              <i class="fas fa-check me-1"></i> Xác nhận
            </button>
          </form>
        <% } %>
      </div>
    </div>
  </div>
</div>
